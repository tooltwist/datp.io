(window.webpackJsonp=window.webpackJsonp||[]).push([[143],{669:function(e,t,v){"use strict";v.r(t);var o=v(60),a=Object(o.a)({},(function(){var e=this,t=e.$createElement,v=e._self._c||t;return v("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[v("h1",{attrs:{id:"attribute-coercion-behavior"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#attribute-coercion-behavior"}},[e._v("#")]),e._v(" Attribute Coercion Behavior "),v("MigrationBadges",{attrs:{badges:e.$frontmatter.badges}})],1),e._v(" "),v("div",{staticClass:"custom-block info"},[v("p",{staticClass:"custom-block-title"},[e._v("Info")]),v("p",[e._v("This is a low-level internal API change and does not affect most developers.")])]),v("h2",{attrs:{id:"overview"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#overview"}},[e._v("#")]),e._v(" Overview")]),e._v(" "),v("p",[e._v("Here is a high level summary of the changes:")]),e._v(" "),v("ul",[v("li",[e._v("Drop the internal concept of enumerated attributes and treat those attributes the same as normal non-boolean attributes")]),e._v(" "),v("li",[v("strong",[e._v("BREAKING")]),e._v(": No longer removes attribute if the value is boolean "),v("code",[e._v("false")]),e._v('. Instead, it\'s set as attr="false". To remove the attribute, use '),v("code",[e._v("null")]),e._v(" or "),v("code",[e._v("undefined")]),e._v(".")])]),e._v(" "),v("p",[e._v("For more information, read on!")]),e._v(" "),v("h2",{attrs:{id:"_2-x-syntax"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-x-syntax"}},[e._v("#")]),e._v(" 2.x Syntax")]),e._v(" "),v("p",[e._v("In 2.x, we had the following strategies for coercing "),v("code",[e._v("v-bind")]),e._v(" values:")]),e._v(" "),v("ul",[v("li",[v("p",[e._v("For some attribute/element pairs, Vue is always using the corresponding IDL attribute (property): "),v("a",{attrs:{href:"https://github.com/vuejs/vue/blob/bad3c326a3f8b8e0d3bcf07917dc0adf97c32351/src/platforms/web/util/attrs.js#L11-L18",target:"_blank",rel:"noopener noreferrer"}},[e._v("like "),v("code",[e._v("value")]),e._v(" of "),v("code",[e._v("<input>")]),e._v(", "),v("code",[e._v("<select>")]),e._v(", "),v("code",[e._v("<progress>")]),e._v(", etc"),v("OutboundLink")],1),e._v(".")])]),e._v(" "),v("li",[v("p",[e._v('For "'),v("a",{attrs:{href:"https://github.com/vuejs/vue/blob/bad3c326a3f8b8e0d3bcf07917dc0adf97c32351/src/platforms/web/util/attrs.js#L33-L40",target:"_blank",rel:"noopener noreferrer"}},[e._v("boolean attributes"),v("OutboundLink")],1),e._v('" and '),v("a",{attrs:{href:"https://github.com/vuejs/vue/blob/bad3c326a3f8b8e0d3bcf07917dc0adf97c32351/src/platforms/web/util/attrs.js#L44-L46",target:"_blank",rel:"noopener noreferrer"}},[e._v("xlinks"),v("OutboundLink")],1),e._v(', Vue removes them if they are "falsy" ('),v("a",{attrs:{href:"https://github.com/vuejs/vue/blob/bad3c326a3f8b8e0d3bcf07917dc0adf97c32351/src/platforms/web/util/attrs.js#L52-L54",target:"_blank",rel:"noopener noreferrer"}},[v("code",[e._v("undefined")]),e._v(", "),v("code",[e._v("null")]),e._v(" or "),v("code",[e._v("false")]),v("OutboundLink")],1),e._v(") and adds them otherwise (see "),v("a",{attrs:{href:"https://github.com/vuejs/vue/blob/bad3c326a3f8b8e0d3bcf07917dc0adf97c32351/src/platforms/web/runtime/modules/attrs.js#L66-L77",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),v("OutboundLink")],1),e._v(" and "),v("a",{attrs:{href:"https://github.com/vuejs/vue/blob/bad3c326a3f8b8e0d3bcf07917dc0adf97c32351/src/platforms/web/runtime/modules/attrs.js#L81-L85",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),v("OutboundLink")],1),e._v(").")])]),e._v(" "),v("li",[v("p",[e._v('For "'),v("a",{attrs:{href:"https://github.com/vuejs/vue/blob/bad3c326a3f8b8e0d3bcf07917dc0adf97c32351/src/platforms/web/util/attrs.js#L20",target:"_blank",rel:"noopener noreferrer"}},[e._v("enumerated attributes"),v("OutboundLink")],1),e._v('" (currently '),v("code",[e._v("contenteditable")]),e._v(", "),v("code",[e._v("draggable")]),e._v(" and "),v("code",[e._v("spellcheck")]),e._v("), Vue tries to "),v("a",{attrs:{href:"https://github.com/vuejs/vue/blob/bad3c326a3f8b8e0d3bcf07917dc0adf97c32351/src/platforms/web/util/attrs.js#L24-L31",target:"_blank",rel:"noopener noreferrer"}},[e._v("coerce"),v("OutboundLink")],1),e._v(" them to string (with special treatment for "),v("code",[e._v("contenteditable")]),e._v(" for now, to fix "),v("a",{attrs:{href:"https://github.com/vuejs/vue/issues/9397",target:"_blank",rel:"noopener noreferrer"}},[e._v("vuejs/vue#9397"),v("OutboundLink")],1),e._v(").")])]),e._v(" "),v("li",[v("p",[e._v('For other attributes, we remove "falsy" values ('),v("code",[e._v("undefined")]),e._v(", "),v("code",[e._v("null")]),e._v(", or "),v("code",[e._v("false")]),e._v(") and set other values as-is (see "),v("a",{attrs:{href:"https://github.com/vuejs/vue/blob/bad3c326a3f8b8e0d3bcf07917dc0adf97c32351/src/platforms/web/runtime/modules/attrs.js#L92-L113",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),v("OutboundLink")],1),e._v(").")])])]),e._v(" "),v("p",[e._v('The following table describes how Vue coerce "enumerated attributes" differently with normal non-boolean attributes:')]),e._v(" "),v("table",[v("thead",[v("tr",[v("th",[e._v("Binding expression")]),e._v(" "),v("th",[v("code",[e._v("foo")]),e._v(" "),v("sup",[e._v("normal")])]),e._v(" "),v("th",[v("code",[e._v("draggable")]),e._v(" "),v("sup",[e._v("enumerated")])])])]),e._v(" "),v("tbody",[v("tr",[v("td",[v("code",[e._v(':attr="null"')])]),e._v(" "),v("td",[e._v("-")]),e._v(" "),v("td",[v("code",[e._v('draggable="false"')])])]),e._v(" "),v("tr",[v("td",[v("code",[e._v(':attr="undefined"')])]),e._v(" "),v("td",[e._v("-")]),e._v(" "),v("td",[e._v("-")])]),e._v(" "),v("tr",[v("td",[v("code",[e._v(':attr="true"')])]),e._v(" "),v("td",[v("code",[e._v('foo="true"')])]),e._v(" "),v("td",[v("code",[e._v('draggable="true"')])])]),e._v(" "),v("tr",[v("td",[v("code",[e._v(':attr="false"')])]),e._v(" "),v("td",[e._v("-")]),e._v(" "),v("td",[v("code",[e._v('draggable="false"')])])]),e._v(" "),v("tr",[v("td",[v("code",[e._v(':attr="0"')])]),e._v(" "),v("td",[v("code",[e._v('foo="0"')])]),e._v(" "),v("td",[v("code",[e._v('draggable="true"')])])]),e._v(" "),v("tr",[v("td",[v("code",[e._v('attr=""')])]),e._v(" "),v("td",[v("code",[e._v('foo=""')])]),e._v(" "),v("td",[v("code",[e._v('draggable="true"')])])]),e._v(" "),v("tr",[v("td",[v("code",[e._v('attr="foo"')])]),e._v(" "),v("td",[v("code",[e._v('foo="foo"')])]),e._v(" "),v("td",[v("code",[e._v('draggable="true"')])])]),e._v(" "),v("tr",[v("td",[v("code",[e._v("attr")])]),e._v(" "),v("td",[v("code",[e._v('foo=""')])]),e._v(" "),v("td",[v("code",[e._v('draggable="true"')])])])])]),e._v(" "),v("p",[e._v("We can see from the table above, current implementation coerces "),v("code",[e._v("true")]),e._v(" to "),v("code",[e._v("'true'")]),e._v(" but removes the attribute if it's "),v("code",[e._v("false")]),e._v(". This also led to inconsistency and required users to manually coerce boolean values to string in very common use cases like "),v("code",[e._v("aria-*")]),e._v(" attributes like "),v("code",[e._v("aria-selected")]),e._v(", "),v("code",[e._v("aria-hidden")]),e._v(", etc.")]),e._v(" "),v("h2",{attrs:{id:"_3-x-syntax"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-x-syntax"}},[e._v("#")]),e._v(" 3.x Syntax")]),e._v(" "),v("p",[e._v('We intend to drop this internal concept of "enumerated attributes" and treat them as normal non-boolean HTML attributes.')]),e._v(" "),v("ul",[v("li",[e._v("This solves the inconsistency between normal non-boolean attributes and “enumerated attributes”")]),e._v(" "),v("li",[e._v("It also makes it possible to use values other than "),v("code",[e._v("'true'")]),e._v(" and "),v("code",[e._v("'false'")]),e._v(", or even keywords yet to come, for attributes like "),v("code",[e._v("contenteditable")])])]),e._v(" "),v("p",[e._v("For non-boolean attributes, Vue will stop removing them if they are "),v("code",[e._v("false")]),e._v(" and coerce them to "),v("code",[e._v("'false'")]),e._v(" instead.")]),e._v(" "),v("ul",[v("li",[e._v("This solves the inconsistency between "),v("code",[e._v("true")]),e._v(" and "),v("code",[e._v("false")]),e._v(" and makes outputting "),v("code",[e._v("aria-*")]),e._v(" attributes easier")])]),e._v(" "),v("p",[e._v("The following table describes the new behavior:")]),e._v(" "),v("table",[v("thead",[v("tr",[v("th",[e._v("Binding expression")]),e._v(" "),v("th",[v("code",[e._v("foo")]),e._v(" "),v("sup",[e._v("normal")])]),e._v(" "),v("th",[v("code",[e._v("draggable")]),e._v(" "),v("sup",[e._v("enumerated")])])])]),e._v(" "),v("tbody",[v("tr",[v("td",[v("code",[e._v(':attr="null"')])]),e._v(" "),v("td",[e._v("-")]),e._v(" "),v("td",[e._v("- "),v("sup",[e._v("*")])])]),e._v(" "),v("tr",[v("td",[v("code",[e._v(':attr="undefined"')])]),e._v(" "),v("td",[e._v("-")]),e._v(" "),v("td",[e._v("-")])]),e._v(" "),v("tr",[v("td",[v("code",[e._v(':attr="true"')])]),e._v(" "),v("td",[v("code",[e._v('foo="true"')])]),e._v(" "),v("td",[v("code",[e._v('draggable="true"')])])]),e._v(" "),v("tr",[v("td",[v("code",[e._v(':attr="false"')])]),e._v(" "),v("td",[v("code",[e._v('foo="false"')]),e._v(" "),v("sup",[e._v("*")])]),e._v(" "),v("td",[v("code",[e._v('draggable="false"')])])]),e._v(" "),v("tr",[v("td",[v("code",[e._v(':attr="0"')])]),e._v(" "),v("td",[v("code",[e._v('foo="0"')])]),e._v(" "),v("td",[v("code",[e._v('draggable="0"')]),e._v(" "),v("sup",[e._v("*")])])]),e._v(" "),v("tr",[v("td",[v("code",[e._v('attr=""')])]),e._v(" "),v("td",[v("code",[e._v('foo=""')])]),e._v(" "),v("td",[v("code",[e._v('draggable=""')]),e._v(" "),v("sup",[e._v("*")])])]),e._v(" "),v("tr",[v("td",[v("code",[e._v('attr="foo"')])]),e._v(" "),v("td",[v("code",[e._v('foo="foo"')])]),e._v(" "),v("td",[v("code",[e._v('draggable="foo"')]),e._v(" "),v("sup",[e._v("*")])])]),e._v(" "),v("tr",[v("td",[v("code",[e._v("attr")])]),e._v(" "),v("td",[v("code",[e._v('foo=""')])]),e._v(" "),v("td",[v("code",[e._v('draggable=""')]),e._v(" "),v("sup",[e._v("*")])])])])]),e._v(" "),v("p",[v("small",[e._v("*: changed")])]),e._v(" "),v("p",[e._v("Coercion for boolean attributes is left untouched.")]),e._v(" "),v("h2",{attrs:{id:"migration-strategy"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#migration-strategy"}},[e._v("#")]),e._v(" Migration Strategy")]),e._v(" "),v("h3",{attrs:{id:"enumerated-attributes"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#enumerated-attributes"}},[e._v("#")]),e._v(" Enumerated attributes")]),e._v(" "),v("p",[e._v("The absence of an enumerated attribute and "),v("code",[e._v('attr="false"')]),e._v(" may produce different IDL attribute values (which will reflect the actual state), described as follows:")]),e._v(" "),v("table",[v("thead",[v("tr",[v("th",[e._v("Absent enumerated attr")]),e._v(" "),v("th",[e._v("IDL attr & value")])])]),e._v(" "),v("tbody",[v("tr",[v("td",[v("code",[e._v("contenteditable")])]),e._v(" "),v("td",[v("code",[e._v("contentEditable")]),e._v(" → "),v("code",[e._v("'inherit'")])])]),e._v(" "),v("tr",[v("td",[v("code",[e._v("draggable")])]),e._v(" "),v("td",[v("code",[e._v("draggable")]),e._v(" → "),v("code",[e._v("false")])])]),e._v(" "),v("tr",[v("td",[v("code",[e._v("spellcheck")])]),e._v(" "),v("td",[v("code",[e._v("spellcheck")]),e._v(" → "),v("code",[e._v("true")])])])])]),e._v(" "),v("p",[e._v("Since we no longer coerce "),v("code",[e._v("null")]),e._v(" to "),v("code",[e._v("'false'")]),e._v(" for “enumerated properties” in 3.x, in the case of "),v("code",[e._v("contenteditable")]),e._v(" and "),v("code",[e._v("spellcheck")]),e._v(", developers will need to change those "),v("code",[e._v("v-bind")]),e._v(" expressions that used to resolve to "),v("code",[e._v("null")]),e._v(" to resolve to "),v("code",[e._v("false")]),e._v(" or "),v("code",[e._v("'false'")]),e._v(" in order to maintain the same behavior as 2.x.")]),e._v(" "),v("p",[e._v("In 2.x, invalid values were coerced to "),v("code",[e._v("'true'")]),e._v(" for enumerated attributes. This was usually unintended and unlikely to be relied upon on a large scale. In 3.x "),v("code",[e._v("true")]),e._v(" or "),v("code",[e._v("'true'")]),e._v(" should be explicitly specified.")]),e._v(" "),v("h3",{attrs:{id:"coercing-false-to-false-instead-of-removing-the-attribute"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#coercing-false-to-false-instead-of-removing-the-attribute"}},[e._v("#")]),e._v(" Coercing "),v("code",[e._v("false")]),e._v(" to "),v("code",[e._v("'false'")]),e._v(" instead of removing the attribute")]),e._v(" "),v("p",[e._v("In 3.x, "),v("code",[e._v("null")]),e._v(" or "),v("code",[e._v("undefined")]),e._v(" should be used to explicitly remove an attribute.")]),e._v(" "),v("h3",{attrs:{id:"comparison-between-2-x-3-x-behavior"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#comparison-between-2-x-3-x-behavior"}},[e._v("#")]),e._v(" Comparison between 2.x & 3.x behavior")]),e._v(" "),v("table",[v("thead",[v("tr",[v("th",[e._v("Attribute")]),e._v(" "),v("th",[v("code",[e._v("v-bind")]),e._v(" value "),v("sup",[e._v("2.x")])]),e._v(" "),v("th",[v("code",[e._v("v-bind")]),e._v(" value "),v("sup",[e._v("3.x")])]),e._v(" "),v("th",[e._v("HTML output")])])]),e._v(" "),v("tbody",[v("tr",[v("td",{attrs:{rowspan:"3"}},[e._v("2.x “Enumerated attrs”"),v("br"),v("small",[e._v("i.e. "),v("code",[e._v("contenteditable")]),e._v(", "),v("code",[e._v("draggable")]),e._v(" and "),v("code",[e._v("spellcheck")]),e._v(".")])]),e._v(" "),v("td",[v("code",[e._v("undefined")])]),e._v(" "),v("td",[v("code",[e._v("undefined")]),e._v(", "),v("code",[e._v("null")])]),e._v(" "),v("td",[v("i",[e._v("removed")])])]),e._v(" "),v("tr",[v("td",[v("code",[e._v("true")]),e._v(", "),v("code",[e._v("'true'")]),e._v(", "),v("code",[e._v("''")]),e._v(", "),v("code",[e._v("1")]),e._v(",\n        "),v("code",[e._v("'foo'")])]),e._v(" "),v("td",[v("code",[e._v("true")]),e._v(", "),v("code",[e._v("'true'")])]),e._v(" "),v("td",[v("code",[e._v('"true"')])])]),e._v(" "),v("tr",[v("td",[v("code",[e._v("null")]),e._v(", "),v("code",[e._v("false")]),e._v(", "),v("code",[e._v("'false'")])]),e._v(" "),v("td",[v("code",[e._v("false")]),e._v(", "),v("code",[e._v("'false'")])]),e._v(" "),v("td",[v("code",[e._v('"false"')])])]),e._v(" "),v("tr",[v("td",{attrs:{rowspan:"2"}},[e._v("Other non-boolean attrs"),v("br"),v("small",[e._v("eg. "),v("code",[e._v("aria-checked")]),e._v(", "),v("code",[e._v("tabindex")]),e._v(", "),v("code",[e._v("alt")]),e._v(", etc.")])]),e._v(" "),v("td",[v("code",[e._v("undefined")]),e._v(", "),v("code",[e._v("null")]),e._v(", "),v("code",[e._v("false")])]),e._v(" "),v("td",[v("code",[e._v("undefined")]),e._v(", "),v("code",[e._v("null")])]),e._v(" "),v("td",[v("i",[e._v("removed")])])]),e._v(" "),v("tr",[v("td",[v("code",[e._v("'false'")])]),e._v(" "),v("td",[v("code",[e._v("false")]),e._v(", "),v("code",[e._v("'false'")])]),e._v(" "),v("td",[v("code",[e._v('"false"')])])])])]),e._v(" "),v("p",[v("RouterLink",{attrs:{to:"/guide/junkyard/migration/migration-build.html#compat-configuration"}},[e._v("Migration build flags:")])],1),e._v(" "),v("ul",[v("li",[v("code",[e._v("ATTR_FALSE_VALUE")])]),e._v(" "),v("li",[v("code",[e._v("ATTR_ENUMERATED_COERCION")])])])])}),[],!1,null,null,null);t.default=a.exports}}]);