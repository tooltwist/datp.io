(window.webpackJsonp=window.webpackJsonp||[]).push([[242],{764:function(e,t,s){"use strict";s.r(t);var i=s(60),n=Object(i.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"_7-sleeping"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-sleeping"}},[e._v("#")]),e._v(" 7 - Sleeping")]),e._v(" "),s("p",[e._v("In some circumstances it is necessary to wait for task\nto complete before proceeding. For example, in a banking\nsystem we might initiate a transfer with a 3rd party API,\nand then wait a period of time before we ask if it has completed.")]),e._v(" "),s("p",[e._v("DATP allows a pipeline to put itself to sleep using\nthe function "),s("code",[e._v("instance.retryLater()")]),e._v(". After the specified interval the step is queued to be re-run. To allow the step to know how many times it has been restarted a "),s("em",[e._v("retryCounter")]),e._v(" is incremented each time.")]),e._v(" "),s("p",[e._v("In this exercise we want a step that sleeps once and the proceeds,\nso we can sleep if the counter is zero, and continue if the\ncounter is greater than zero.")]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("Your mission")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("Copy "),s("code",[e._v("MySleepingStep.js")]),e._v(" into myProject/steps.")])]),e._v(" "),s("li",[s("p",[e._v("Register the step in app.js.")])]),e._v(" "),s("li",[s("p",[e._v("Add the step to myPipeline, replacing the existing delay step.")])]),e._v(" "),s("li",[s("p",[e._v("Restart the server by saving app.js again.")])]),e._v(" "),s("li",[s("p",[e._v("Run the test for myPipeline and watch the console output from the server.")])]),e._v(" "),s("li",[s("p",[e._v("In MONDAT you can press the "),s("em",[e._v("Refresh")]),e._v(" button to follow the progress.")])]),e._v(" "),s("li",[s("p",[e._v("The "),s("em",[e._v("Cache/Archive")]),e._v(" tab shows the state of the transaction as it progresses.")])])])]),e._v(" "),s("p",[e._v("When a step puts the pipeline to sleep, it goes into hybernation.\nAt the assigned time, the wakeup processor will add the\ntransaction back to the queue for the node group.")]),e._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[e._v("Extra")]),e._v(" "),s("p",[e._v('Create another step, named "sleep10", that sleeps for 10 minutes.')])])])}),[],!1,null,null,null);t.default=n.exports}}]);