(window.webpackJsonp=window.webpackJsonp||[]).push([[241],{763:function(t,e,a){"use strict";a.r(e);var s=a(60),n=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"_6-transaction-routes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-transaction-routes"}},[t._v("#")]),t._v(" 6 - Transaction Routes")]),t._v(" "),a("p",[t._v("Up till now we've been starting transactions via MONDAT, but\nthat's just a testing tool.\nOur real objective is to create an API that applications\ncan call to start transactions.")]),t._v(" "),a("p",[t._v("The first, and easiest way to allow clients to start transactions\nis via the URL shown when your server starts.")]),t._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X PUT --data "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{ \\\n    "metadata": { "webhook": "http://localhost:33340/notify" }, \\\n    "data": { "afield": "xyz" } \\\n}\'')]),t._v(" http://localhost:33370/datp/1.0/tx/start/null\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("p",[t._v("While that works it is generally better to define your own route\nto start the transaction. Some of the benefits are that your route...")]),t._v(" "),a("ul",[a("li",[t._v("can provide a simpler interface.")]),t._v(" "),a("li",[t._v("can hard code short or long polling (whatever is best for that transaction).")]),t._v(" "),a("li",[t._v("validate inputs before starting the transaction.")]),t._v(" "),a("li",[t._v("conceal details of your pipelines from the outside world.")])]),t._v(" "),a("h2",{attrs:{id:"create-a-route-handler-to-start-the-transaction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-a-route-handler-to-start-the-transaction"}},[t._v("#")]),t._v(" Create a route / handler to start the transaction")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("Create folder "),a("code",[t._v("myProject/routes")]),t._v(".")])]),t._v(" "),a("li",[a("p",[t._v("Copy "),a("code",[t._v("COURSE-NOTES/2.6-transaction-routes/myFirstPipelineRoute.js")]),t._v(" into this folder. This code provides the Restify handler to start transaction "),a("em",[t._v("myPipeline")]),t._v(".")])]),t._v(" "),a("li",[a("p",[t._v("Open "),a("code",[t._v("COURSE-FILES/2.6-transaction-routes/app.js")]),t._v(" using "),a("em",[t._v("Open to the Side")]),t._v(", and update your app.js with the code to register the handler above.")])])]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("GET http://localhost:33370/myProject/1.0/myPipeline\n    => handler myPipelineRouteV1()\n    => start transaction 'myPipeine'\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("h2",{attrs:{id:"testing-the-route"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#testing-the-route"}},[t._v("#")]),t._v(" Testing the Route")]),t._v(" "),a("p",[t._v("To test this route, call "),a("a",{attrs:{href:"http://localhost:33370/myProject/1.0/myPipeline",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://localhost:33370/myProject/1.0/myPipeline"),a("OutboundLink")],1),t._v(" with Postman.")]),t._v(" "),a("p",[t._v("Or with curl:")]),t._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" http://localhost:33370/myProject/1.0/myPipeline\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("In some cases you can also use your browser.")]),t._v(" "),a("hr"),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("A Challenge !")]),t._v(" "),a("p",[t._v("We've covered a lot of ground, so let's test your knowledge.")]),t._v(" "),a("ol",[a("li",[t._v("Create a step "),a("code",[t._v("adder")]),t._v(" that reads two numbers "),a("code",[t._v("a")]),t._v(" and "),a("code",[t._v("b")]),t._v(" in the\ninput data, and writes the sum of them to the output.")]),t._v(" "),a("li",[t._v("Place this step in a pipeline.")]),t._v(" "),a("li",[t._v("Create a route for the pipeline "),a("code",[t._v("/myProject/1.0/adder/:a/:b")]),t._v("\nthat calls this pipeline.")]),t._v(" "),a("li",[t._v("Show it working in Postman.")])]),t._v(" "),a("p",[t._v("Tip: In your route you will need to convert a and b from strings to\nnumbers.")])])])}),[],!1,null,null,null);e.default=n.exports}}]);